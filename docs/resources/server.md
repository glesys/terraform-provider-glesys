---
page_title: "glesys_server Resource - terraform-provider-glesys"
subcategory: ""
description: |-
  Create a new Glesys virtual server.
---
# glesys_server (Resource)
Create a new Glesys virtual server.
## Example Usage
```terraform
locals {
  myParams = {
    name             = "Alice"
    numberOfBalloons = 99
  }
}

resource "glesys_server" "kvm" {
  datacenter = "Stockholm"
  memory     = 1024
  storage    = 20
  cpu        = 1
  bandwidth  = 100

  hostname = "www1"

  platform = "KVM"
  template = "debian-11"

  cloudconfigparams = local.myParams
  cloudconfig       = "#cloud-config\nbootcmd:\n  - echo 'Hello {{params.name}}!'"

  user {
    username = "alice"
    publickeys = [
      "ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAINOCh8br7CwZDMGmINyJgBip943QXgkf7XdXrDMJf5Dl alice@example.com",
      "ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIOfN4dBsS2p1UX+DP6RicdxAYCCeRK8mzCldCS0W9A+5 alice@ws.example.com"
    ]
    password = "hunter4!"
  }
  user {
    username   = "bob"
    publickeys = ["ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAINOCh8br7CwZDMGmINyJgBip943QXgkf7XdXrDMJf5Dl bob@example.com"]
    password   = "hunter444!"
  }
}

# KVM with backups_schedule

resource "glesys_server" "kvm" {
  datacenter = "Stockholm"
  memory     = 1024
  storage    = 20
  cpu        = 1
  bandwidth  = 100

  hostname = "www1"

  platform = "KVM"
  template = "debian-11"

  user {
    username = "alice"
    publickeys = [
      "ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAINOCh8br7CwZDMGmINyJgBip943QXgkf7XdXrDMJf5Dl alice@example.com",
      "ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIOfN4dBsS2p1UX+DP6RicdxAYCCeRK8mzCldCS0W9A+5 alice@ws.example.com"
    ]
    password = "hunter4!"
  }
  backups_schedule {
    frequency = "daily"
    retention = 7
  }
  backups_schedule {
    frequency = "weekly"
    retention = 4
  }
}
# Advanced example using variables
# Set some variables
variable "datacenter" {
  default = "Falkenberg"
}

# Instance defaults
variable "description" {
  default = "tf-vmware-"
}

variable "bw" {
  default     = 100
  description = "Default bandwidth"
}

variable "mem" {
  default     = 1024
  description = "Default memory"
}

variable "storage" {
  default     = 20
  description = "Default storage"
}

variable "platform" {
  default = {
    Falkenberg = "KVM"
    Stockholm  = "VMware"
  }
}

variable "region" {
  default = {
    "0" = "Falkenberg"
    "1" = "Stockholm"
  }
}

variable "region_short" {
  default = {
    "0" = "fbg"
    "1" = "sth"
  }
}

variable "region_os" {
  default = {
    Falkenberg = "debian9"
    Stockholm  = "debian9"
  }
}

variable "template" {
  default = {
    debian8 = "Debian 8 64-bit"
    debian9 = "Debian 9 64-bit"
  }
}

variable "templatelist" {
  default = {
    "0" = "Centos 7 64-bit"
    "1" = "Centos 8 64-bit"
    "2" = "Debian 8 64-bit"
    "3" = "Debian 9 64-bit"
    "4" = "Debian 10 64-bit"
    "5" = "Ubuntu 14.04 LTS 64-bit"
    "6" = "Ubuntu 16.04 LTS 64-bit"
    "7" = "Ubuntu 18.04 LTS 64-bit"
    "8" = "Ubuntu 20.04 LTS 64-bit"
  }
}

# Create the server resource
resource "glesys_server" "vmware" {
  count       = 1
  bandwidth   = var.bw
  cpu         = 1
  datacenter  = "Falkenberg"
  description = "${var.description}-example-${count.index}"
  hostname    = "vmware-vm-${count.index}"
  memory      = var.mem
  platform    = "VMware"
  storage     = var.storage
  template    = var.templatelist[count.index]
  password    = "hunter2!"
}
```
### Cloud Config
When using the KVM platform you can provide a custom cloud-config file to configure and provision your server automatically.

Examples can be found in the [GleSYS API - Cloud config documentation](https://github.com/glesys/api-docs/wiki/Using-cloud-config-to-configure-you-KVM-server)

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `bandwidth` (Number) Server network adapter bandwidth
- `cpu` (Number) Server CPU cores count
- `datacenter` (String) Server datacenter placement
- `hostname` (String) Server hostname
- `memory` (Number) Server RAM setting
- `storage` (Number) Server disk space

### Optional

- `backups_schedule` (Block Set) KVM Server backup schedule definition. (see [below for nested schema](#nestedblock--backups_schedule))
- `campaigncode` (String) Campaigncode used during creation for possible discount
- `cloudconfig` (String) Cloudconfig used to provision server using a provided cloud-config mustache template.
- `cloudconfigparams` (Map of String) Cloudconfigparams is used to provide additional parameters to the template in `cloudconfig` using a map. This can be set using a Terraform Local Value.
- `description` (String) Server description
- `ipv4_address` (String) Server IPv4 address, set `none` to disable IP allocation
- `ipv6_address` (String) Server IPv6 address, set `none` to disable IP allocation
- `password` (String) Server root password, VMware only
- `platform` (String) Server virtualisation platform, `KVM` or `VMware`
- `publickey` (String)
- `template` (String) Server OS template
- `user` (Block Set) (see [below for nested schema](#nestedblock--user))

### Read-Only

- `extra_disks` (List of String) Disks associated with the server. Use `glesys_server_disk` resource to manage these.
- `id` (String) The ID of this resource.
- `islocked` (Boolean) Server locked state
- `isrunning` (Boolean) Server running state
- `network_adapters` (List of Object) Network adapters associated with the server. `glesys_networkadapter` (see [below for nested schema](#nestedatt--network_adapters))

<a id="nestedblock--backups_schedule"></a>
### Nested Schema for `backups_schedule`

Required:

- `frequency` (String)
- `retention` (Number)


<a id="nestedblock--user"></a>
### Nested Schema for `user`

Required:

- `publickeys` (List of String) User SSH key(s), as a list. '["ssh-rsa abc...", "ssh-rsa foo..."]'
- `username` (String)

Optional:

- `password` (String)


<a id="nestedatt--network_adapters"></a>
### Nested Schema for `network_adapters`

Read-Only:

- `adaptertype` (String)
- `bandwidth` (Number)
- `id` (String)
- `name` (String)
- `networkid` (String)
## Import
Import is supported using the following syntax:
```shell
# glesys_server Import
$ terraform import glesys_server.example kvm123456
```
